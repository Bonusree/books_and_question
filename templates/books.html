{% extends 'master.html' %}
{%load static%}
{% block title %}
books
{% endblock %}

{% block content %}

<div class="container " style="margin-top:20px; margin-left:100px;">

  <!-- navbar -->

  <ul class="nav nav-tabs nav-justified">
    <li class="nav-item">
      <a class="nav-link active" href="#section1">overview</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#section2">Available </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#section3">Need</a>
    </li>

  </ul>

  <div id="section2" class="card text-dark bg-light m-4" style="max-width:
              100%;">
    <div class="card-header d-inline-flex ">
      <div class="flex-fill">Available</div>

      <div>
        {% if user.is_authenticated %}
        <button type="button" class="btn btn-sm border btn-default fw-bold mx-3"
          style="color:blue;" data-bs-toggle="modal"
          data-bs-target="#add_available_books">Add </button>
        <button type="button" class="btn btn-default btn-sm border fw-bold"
          style="color:blue;" data-bs-toggle="modal"
          data-bs-target="#edit_available_books">edit</button>
        {%endif%}
      </div>
    </div>
    <input type="text" style="width: 95%;" class="m-3" id="search_available" onkeyup="myFunction()" placeholder="Search for Course Title..">
    <div class="card m-4 p-3">
      {% for course_title, book_data in books.items%}
      {%if book_data.available%}
      <h4 id="available_course" class="m-2">{{course_title|capfirst}}</h4>

      <table class="table table-striped table-bordered m-3" style="width:90%;">

        <thead>
          <tr>
            <th>#</th>
            <th>Books name</th>
            <th>Writer Name</th>
            <th>Owner Name</th>
            <th>Batch</th>
            <th>ID</th>
          </tr>
        </thead>
        <tbody>
          {%for b in book_data.available%}
          <tr>
            <td>#</td>
            <td>{{b.b_name|capfirst}}</td>
            <td>{{b.writer_name|capfirst}}</td>
            <td>{{b.owner_name|capfirst}}</td>
            <td>{{b.session}}</td>
            <td>{{b.roll}}</td>
            
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {%endif%}

      {% endfor %}

    </div>
  </div>
  <div id="section3" class="card text-dark bg-light m-4" style="max-width:
              100%;">
    <div class="card-header d-inline-flex ">
      <div class="flex-fill">Need</div>
      <div>
        {% if user.is_authenticated %}
        <button type="button" class="btn btn-sm border btn-default fw-bold mx-3"
          style="color:blue;" data-bs-toggle="modal"
          data-bs-target="#add_need_books">Add </button>
        <button type="button" class="btn btn-default btn-sm border fw-bold"
          style="color:blue;" data-bs-toggle="modal"
          data-bs-target="#edit_need_books">edit</button>
        {%endif%}
      </div>
    </div>

    <div class="card m-4 p-3">
      {% for course_title, book_data in books.items%}

      {%if book_data.need%}

      <h4 class="m-2">{{course_title|capfirst}}</h4>
      <table class="table table-striped table-bordered m-3" style="width:95%;">

        <thead>
          <tr>
            <th>#</th>
            <th>Books name</th>
            <th>Writer Name</th>
            <th>Owner Name</th>
            <th>Batch</th>
            <th>ID</th>
           
          </tr>
        </thead>
        <tbody>
          {%for b in book_data.need%}
          <tr>
            <td>#</td>
            <td>{{b.b_name|capfirst}}</td>
            <td>{{b.writer_name|capfirst}}</td>
            <td>{{b.borrower|capfirst}}</td>
            <td>{{b.session}}</td>
            <td>{{b.roll}}</td>
            
          </tr>
          {%endfor%}
        </tbody>
      </table>

      {%endif%}
      {% endfor %}
    </div>
  </div>

  <!--modal-->
  <div class="modal fade" id="add_available_books" tabindex="-1"
    aria-labelledby="addLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addLabel">Add the book's name what you
            have</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"
            aria-label="Close"></button>
        </div>
        <div class="modal-body">

          <form action="{% url 'add_available_books' %}" method="POST">
            {% csrf_token %}
            <div class="form-group mt-2">

              <input type="text" class="form-control my-input" id="name"
                name="course_title"
                placeholder="Enter Course title">
            </div>

            <div class="form-group mt-2">
              <input type="text" class="form-control" id="ID" name="book_name"
                placeholder="Enter book name">
            </div>
            <div class="form-group mt-2">
              <input type="text" class="form-control" id="ID" name="writer_name"
                placeholder="Enter writer name">
            </div>

            <div class="text-center">
              <button type="submit" class="btn btn-secondary text-white m-3">Add</button>
            </div>

          </form>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="edit_available_books" tabindex="-1"
    aria-labelledby="editLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addLabel">Name of the books that you added</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"
            aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <ol>
            <li><form style="margin-top:20px;" method="POST"
                enctype="multipart/form-data">
                {% csrf_token %}
                name of the book
                <input type="radio" value="yes" name='is_need'>

              </form>
            </li>
            <ol>
            </div>
          </div>
        </div>
      </div>

      <!--Need-->
      <!--modal-->
      <div class="modal fade" id="add_need_books" tabindex="-1"
        aria-labelledby="addLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="addLabel">Add the book's name what you
                have</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal"
                aria-label="Close"></button>
            </div>
            <div class="modal-body">

              <form action="{% url 'add_need_books' %}" method="POST">
                {% csrf_token %}
                <div class="form-group mt-2">

                  <input type="text" class="form-control my-input" id="name"
                    name="course_title"
                    placeholder="Enter Course title">
                </div>

                <div class="form-group mt-2">
                  <input type="text" class="form-control" id="ID"
                    name="book_name"
                    placeholder="Enter book name">
                </div>
                <div class="form-group mt-2">
                  <input type="text" class="form-control" id="ID"
                    name="writer_name"
                    placeholder="Enter writer name">
                </div>

                <div class="text-center">
                  <button type="submit" class="btn btn-secondary text-white m-3">Add</button>
                </div>

              </form>
            </div>
          </div>
        </div>
      </div>
      <div class="modal fade" id="edit_need_books" tabindex="-1"
        aria-labelledby="editLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="addLabel">Name of the books that you
                added</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal"
                aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <ol>
                <li><form style="margin-top:20px;" method="POST"
                    enctype="multipart/form-data">
                    {% csrf_token %}
                    name of the book
                    <input type="radio" value="yes">
                  </li></form>
                <ol>
                </div>
              </div>
            </div>
          </div>

 <script>
$(document).ready(function() {
  // Get all menu items
  var menuItems = $('.nav-link');

  // Add click event listener to each menu item
  menuItems.click(function() {
    // Remove active class from all menu items
    menuItems.removeClass('active');

    // Add active class to the clicked menu item
    $(this).addClass('active');
  });
});

//search available
var a_b = document.getElementById("search_available");
function myFunction() {
  // Declare variables
  var input, filter, table, tr, td, i, txtValue;
  
  filter = input.value.toUpperCase();
  table = document.getElementById("available_course");
  tr = table.getElementsByTagName("tr");

  // Loop through all table rows, and hide those who don't match the search query
  for (i = 0; i < tr.length; i++) {
    td = tr[i].getElementsByTagName("td")[1];
    if (td) {
      txtValue = td.textContent || td.innerText;
      if (txtValue.toUpperCase().indexOf(filter) > -1) {
        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }
  }
}
</script> 
{% endblock%}